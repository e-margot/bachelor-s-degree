# Обучение нейронных сетей классификации тепловизионных снимков на основе изображений видимого спектра
<h2>Цель исследования</h2>

Целью исследования является разработка метода обучения нейронных
сетей с помощью имитации тепловизионных снимков на основе изображений
видимого спектра. Для достижения цели были выполнены следующие задачи:

1. Исследованы существующие базы данных со снимками видимого
спектра и снимками инфракрасного спектра;
2. Рассмотрены методы обучения нейронных сетей на наборах
данных с тепловизионными снимками;
3. Разработан и реализован метод имитации тепловизионных
снимков для обучения нейронных сетей в задаче распознавания образов;
4. Проведена экспериментальную проверку метода и оценить
эффективность разработанного метода.

<h2>Используемый набор данных</h2>
Базу данных «FLIR ADAS Thermal Dataset v2» (https://adas-dataset-v2.flirconservator.com/#downloadguide) от компании FLIR Systems (https://www.flir.pro/), одной из крупнейшей компаний в мире, занимающейся разработкой и производством тепловизионного оборудования. «FLIR ADAS Thermal Dataset v2» включает в себя аннотированные кадры тепловизионного и телевизионного спектра, предназначенные для задачи распознавания объектов. Входными данными для нейронной
сети являются кадры из видеоряда, снятого на тепловизор и на камеру видимого диапазона. Для каждой из выборок описан файл «index.json» и «coco.json». Формат первого файла был создан для инструмента управления наборами данных Teledyne FLIR под названием Conservator. Аннотация напоминает формат файла MS Coco Detection Dataset, но заполненного дополнительными параметрами. «сoco.json» описан как и аннотация к набору данных COCO. 

<table align="center"> 
 <tr>
    <td><img src="/thermal_img.png" alt="Thermal image from dataset"/></td>
    <td><img src="/rgb_img.png" alt="Thermal image from dataset"/></td>
  </tr>
  <tr>
    <td>Пример тепловизионного объекта из набора данных</td>
    <td>Пример телевизионного объекта из набора данных</td>
  </tr>

</table> 
<h2>Архитектура ResNet</h2>
Остаточная нейронная сеть ResNet является мощным инструментом для задач классификации. Об этом хорошо говорят значения производительности по сравнению с другими моделями глубокого обучения. Её архитектура построена так, что при увеличении слоёв производительность только повышается, в отличии от VGG-19 «простой» нейронной сети. ResNet является классическим примером модели обучения для задач классификации, что дает возможность проводить чистый эксперимент с аугментацией данных.
<h2>Результаты</h2>
Были проведены модификации набора данных. На каждом снимке вырезаны объекты, создана аннотация базы данных. Созданный набор подходит для задачи классификации, что изначально и требовалось. 
<br><br>Помимо преобразованных баз данных, были переопределены методы чтения файлов json. Для этого были изучены классы COCO и Сoco_Detection, разобраны методы классов. 
<br><br>На подготовленных данных был проведен эксперимент с аугментацией снимков. Были рассмотрены различные варианты модификаций изображений, приведены примеры. Некоторые параметры подобраны с помощью зрительного анализа, некоторые эмпирическим путём, согласно точности распознавания. 
<br><br>Лучшим результатом среди всех вариантов аугментаций данных оказался подход с использованием увеличения резкости в 10 раз и случайным преобразованием снимка в негативный с вероятностью 60%. Точность распознавания такого набора данных на тепловизионных снимках показал результат в 0,6379 по сравнению с 0,5112 без аугментаций.



<table align="center"> 
<tr>
<th>Аугментации</th><th>Точность распознавания на тепловизионной выборке</th>
</tr>
<tr>
<th>-</th><th>51%</th>
</tr>
<tr>
<th>Преобразование снимков в негативные</th><th>47%</th>
</tr>
<tr>
<th>Преобразование снимков в негативные и увеличение яркости</th><th>44%</th>
</tr>
<tr>
<th>Увеличение яркости, контрастности и резкости изображений</th><th>49%</th>
</tr>
<tr>
<th>Увеличение резкости в 10 раз</th><th>51%</th>
</tr>
<tr>
<th>Случайное преобразование снимков в негативные с вероятностью 30% и увеличение резкости в 10 раз</th><th>63,52%</th>
</tr>
<tr>
<th>Случайное преобразование снимков в негативные с вероятностью 60% и увеличение резкости в 10 раз</th><th>63,79%</th>
</tr>
</table>
<br><br>
<table align="center"> 
<tr>
<th>Набор данных</th><th>Аугментации</th><th>Точность распознавания на тепловизионной выборке</th>
</tr>
<tr>
<th>Изображения инфракрасного спектра</th><th>-</th><th>86%</th>
</tr>
<tr>
<th>Изображения видимого спектра</th><th>-</th><th>51%</th>
</tr>
<tr>
<th>Изображения видимого спектра</th><th>Случайное преобразование снимков в негативные с вероятностью 60% и увеличение резкости в 10 раз</th><th>63,79</th>
</tr>
</table>
