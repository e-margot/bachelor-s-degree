# Обучение нейронных сетей классификации тепловизионных снимков на основе изображений видимого спектра

## Предпосылки исследования
Датасеты для обучения моделей классификации объектов на тепловизионных снимах очень малочислены по количеству и размерам, по сравнению с датасетами изображений видимого спектра.
В случае если можно обучать нейронные сети на агументированных изображениях видимого спектра, то проблема малого количества данных перестает существовать.  
Модели для работы с тепловизионными снимками требуется  в различных областях, начиная от инфракрасных камер безопасности, заканчивая промышленными камерами на производствах.

<h2>Цель исследования</h2>

Целью исследования является разработка метода обучения нейронных
сетей с помощью имитации тепловизионных снимков на основе изображений
видимого спектра. Для достижения цели были выполнены следующие задачи:

1. Исследованы существующие базы данных со снимками видимого
спектра и снимками инфракрасного спектра;
2. Рассмотрены методы обучения нейронных сетей на наборах
данных с тепловизионными снимками;
3. Разработан и реализован метод имитации тепловизионных
снимков для обучения нейронных сетей в задаче распознавания образов;
4. Проведена экспериментальную проверку метода и оценить
эффективность разработанного метода.


## Дальнейшее развитие проекта
1.    Подобрать Learning Rate – для достижения плато стабильной точности классификации на обучении
2.    Упростить загрузку и сохранение моделей - рассмотреть средства контроля версий моделей
3.    Построить и провести тестирование лучшей модели по валидационной выборке на тестовом наборе данных
4.    Контенейризовать проект для запуска на удаленных сервисах.
5.    Попробовать другие архитектуры, в том числе Resnet34 и Resnet50
6.    (VERY OPTIONAL) Аугментации – попробовать аугментации по цветовым каналам

<h2>Используемый набор данных</h2>
Базу данных «FLIR ADAS Thermal Dataset v2» (https://adas-dataset-v2.flirconservator.com/#downloadguide) от компании FLIR Systems (https://www.flir.pro/), одной из крупнейшей компаний в мире, занимающейся разработкой и производством тепловизионного оборудования. «FLIR ADAS Thermal Dataset v2» включает в себя аннотированные кадры тепловизионного и телевизионного спектра, предназначенные для задачи распознавания объектов. Входными данными для нейронной
сети являются кадры из видеоряда, снятого на тепловизор и на камеру видимого диапазона. Для каждой из выборок описан файл «index.json» и «coco.json». Формат первого файла был создан для инструмента управления наборами данных Teledyne FLIR под названием Conservator. Аннотация напоминает формат файла MS Coco Detection Dataset, но заполненного дополнительными параметрами. «сoco.json» описан как и аннотация к набору данных COCO. 

<table align="center"> 
 <tr>
    <td><img src="/thermal_img.png" alt="Thermal image from dataset"/></td>
    <td><img src="/rgb_img.png" alt="Thermal image from dataset"/></td>
  </tr>
  <tr>
    <td>Пример тепловизионного объекта из набора данных</td>
    <td>Пример телевизионного объекта из набора данных</td>
  </tr>

</table> 

## Архитектура Модели

В качестве модели для решения задачи классификации используется CNN Resnet.
Данная модель показывает отличные результаты работы на различных задачах компьютерного зрения.  
А остаточный блок позволяет минимизировать проблему исчезающего градиента в глубоких нейросетях.

## Результаты
### Подготовка данных
Были проведены модификации набора данных. На каждом снимке вырезаны объекты, создана аннотация базы данных. Созданный набор подходит для задачи классификации, что изначально и требовалось. 
Помимо преобразованных баз данных, были переопределены методы чтения файлов json. Для этого были изучены классы COCO и Сoco_Detection, разобраны методы классов. 

### Проведение экспериментов
На подготовленных данных был проведен эксперимент с аугментацией снимков. Были рассмотрены различные варианты модификаций изображений, приведены примеры. Некоторые параметры подобраны с помощью зрительного анализа, некоторые эмпирическим путём, согласно точности распознавания. 


### Метрики
В рамках наших экспериментов мы пользовались метрикой accuracy, по причине большого количества классов (80).   
Лучшим результатом среди всех вариантов аугментаций данных оказался подход с использованием увеличения резкости в 10 раз и случайным преобразованием снимка в негативный с вероятностью 60%. Точность распознавания такого набора данных на тепловизионных снимках показал результат в 0,6379 по сравнению с 0,5112 без аугментаций.



<table align="center"> 
<tr>
<th>Аугментации</th><th>Accuracy на тепловизионной выборке</th>
</tr>
<tr>
<th>-</th><th>51%</th>
</tr>
<tr>
<th>Преобразование снимков в негативные</th><th>47%</th>
</tr>
<tr>
<th>Преобразование снимков в негативные и увеличение яркости</th><th>44%</th>
</tr>
<tr>
<th>Увеличение яркости, контрастности и резкости изображений</th><th>49%</th>
</tr>
<tr>
<th>Увеличение резкости в 10 раз</th><th>51%</th>
</tr>
<tr>
<th>Случайное преобразование снимков в негативные с вероятностью 30% и увеличение резкости в 10 раз</th><th>63,52%</th>
</tr>
<tr>
<th>Случайное преобразование снимков в негативные с вероятностью 60% и увеличение резкости в 10 раз</th><th>63,79%</th>
</tr>
</table>
<br><br>
<table align="center"> 
<tr>
<th>Набор данных</th><th>Аугментации</th><th>Accuracy на тепловизионной выборке</th>
</tr>
<tr>
<th>Изображения инфракрасного спектра</th><th>-</th><th>86%</th>
</tr>
<tr>
<th>Изображения видимого спектра</th><th>-</th><th>51%</th>
</tr>
<tr>
<th>Изображения видимого спектра</th><th>Случайное преобразование снимков в негативные с вероятностью 60% и увеличение резкости в 10 раз</th><th>63,79</th>
</tr>
</table>
